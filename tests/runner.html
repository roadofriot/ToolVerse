<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ToolVerse Test Runner üß™</title>
    <style>
        body {
            font-family: system-ui, sans-serif;
            padding: 20px;
            background: #111;
            color: #eee;
        }

        h1 {
            border-bottom: 2px solid #333;
            padding-bottom: 10px;
        }

        .test-group {
            margin-bottom: 20px;
            border: 1px solid #333;
            padding: 10px;
            border-radius: 8px;
        }

        .summary {
            margin-top: 20px;
            padding: 15px;
            background: #222;
            border-radius: 8px;
            font-weight: bold;
        }

        .pass {
            color: #4ade80;
        }

        .fail {
            color: #f87171;
        }
    </style>
</head>

<body>
    <h1>ToolVerse Automated Test Runner üß™</h1>
    <div id="results">Running tests...</div>

    <!-- Load Tool Modules -->
    <script type="module">
        import { JSONFormatterLogic } from '../tools/developer/json-formatter/logic.js';

        // Simple assertion library
        const resultsEl = document.getElementById('results');
        let totalPass = 0;
        let totalFail = 0;

        function log(msg, type = 'info') {
            const div = document.createElement('div');
            div.textContent = msg;
            if (type === 'pass') div.className = 'pass';
            if (type === 'fail') div.className = 'fail';
            resultsEl.appendChild(div);
        }

        function assert(condition, message) {
            if (condition) {
                log(`‚úÖ PASS: ${message}`, 'pass');
                totalPass++;
            } else {
                log(`‚ùå FAIL: ${message}`, 'fail');
                totalFail++;
            }
        }

        async function runAllTests() {
            resultsEl.innerHTML = ''; // Clear

            // --- JSON FORMATTER TESTS ---
            log('Testing JSON Formatter...', 'info');

            // Validate
            assert(JSONFormatterLogic.validate('{}').isValid === true, 'Validates empty object');
            assert(JSONFormatterLogic.validate('{"a":1}').isValid === true, 'Validates simple object');
            assert(JSONFormatterLogic.validate('{a:1}').isValid === false, 'Rejects unquoted keys');

            // Format
            const raw = '{"a":1,"b":[1,2]}';
            const formatted = JSONFormatterLogic.format(raw, 2);
            assert(formatted.includes('\n'), 'Formatting adds newlines');
            assert(formatted.includes('  "a": 1'), 'Formatting adds indentation');

            // Minify
            const mini = JSONFormatterLogic.minify('{\n "a": 1 \n}');
            assert(mini === '{"a":1}', 'Minification removes whitespace');

            // --- SUMMARY ---
            const summary = document.createElement('div');
            summary.className = 'summary';
            summary.innerHTML = `
                Total Tests: ${totalPass + totalFail}<br>
                <span class="pass">Passed: ${totalPass}</span><br>
                <span class="${totalFail > 0 ? 'fail' : 'pass'}">Failed: ${totalFail}</span>
            `;
            document.body.appendChild(summary);
        }

        runAllTests();
    </script>
</body>

</html>